name: 🤖 Auto Blog Update & Deploy

on:
  push:
    paths:
      - 'blog/*.html'
  workflow_dispatch:

jobs:
  auto-update-blog:
    name: 📝 Update Blog Index
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '18'
      - run: npm install jsdom fs-extra
      - run: |
          echo "🤖 AI Art Studio ブログ自動更新システム"
          echo "📊 ブログディレクトリをスキャン中..."
          if [ -d "blog" ]; then
            echo "✅ blogディレクトリ発見"
            echo "📝 記事数: $^(ls blog/*.html 2^>/dev/null ^| wc -l^)"
          else
            echo "⚠️  blogディレクトリが見つかりません"
          fi
          echo "🎯 簡易index.html更新中..."
          cat > index.html << 'HTML'
          <!DOCTYPE html>
          <html lang="ja">
          <head>
              <meta charset="UTF-8">
              <title>AI Art Studio - レイナの自動ブログ</title>
              <meta name="description" content="レイナが作った完全自動化ブログシステム">
              <style>
                  body { font-family: Arial, sans-serif; background: #020210; color: #e0faff; margin: 0; padding: 20px; }
                  .container { max-width: 800px; margin: 0 auto; text-align: center; }
                  h1 { color: #8aff00; font-size: 2.5rem; }
                  .status { background: rgba(138,255,0,0.1); padding: 20px; border-radius: 10px; margin: 20px 0; }
              </style>
          </head>
          <body>
              <div class="container">
                  <h1>🤖 AI Art Studio</h1>
                  <p>レイナが作った完全自動化ブログシステムです♪</p>
                  <div class="status">
                      <h2>📊 システム状況</h2>
                      <p>✅ GitHub Actions自動更新システム稼働中</p>
                      <p>🤖 最終更新: $(date)</p>
                      <p>📝 ブログ記事を追加すると自動で更新されます</p>
                  </div>
                  <div class="footer">
                      <p>Made with ❤️ by レイナ - AI技術コンサルタント</p>
                  </div>
              </div>
          </body>
          </html>
          HTML
      - run: |
          git config --local user.email "action@github.com"
          git config --local user.name "AI Studio Bot"
          if [[ -n $(git status --porcelain) ]]; then
            git add index.html
            git commit -m "🤖 Auto-update: $^(date^)"
            git push
          fi
